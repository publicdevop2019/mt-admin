<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://www.ehcache.org/v3"
        xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd">
    <heap-store>
        <!--        max object size is size of a given mapping, if a single instance, in addition with the key,
         is larger than the configured maximum, it will not be cached-->
        <max-object-size unit="MB">1</max-object-size>
    </heap-store>

    <cache alias="userRelationRegion" uses-template="myDefaults"/>
    <cache alias="userRegion" uses-template="myDefaults"/>
    <cache alias="roleRegion" uses-template="myDefaults"/>
    <cache alias="projectRegion" uses-template="myDefaults"/>
    <cache alias="positionRegion" uses-template="myDefaults"/>
    <cache alias="permissionRegion" uses-template="myDefaults"/>
    <cache alias="pendingUserRegion" uses-template="myDefaults"/>
    <cache alias="organizationRegion" uses-template="myDefaults"/>
    <cache alias="endpointRegion" uses-template="myDefaults"/>
    <cache alias="corsProfileRegion" uses-template="myDefaults"/>
    <cache alias="clientRegion" uses-template="myDefaults"/>
    <cache alias="cacheProfileRegion" uses-template="myDefaults"/>
    <cache alias="clientResourceRegion" uses-template="myDefaults"/>
    <cache alias="clientExtResourceRegion" uses-template="myDefaults"/>
    <cache alias="clientTypeRegion" uses-template="myDefaults"/>
    <cache alias="userRelationRoleRegion" uses-template="myDefaults"/>
    <cache alias="userRelationTenantRegion" uses-template="myDefaults"/>
    <cache alias="clientRedirectUrlRegion" uses-template="myDefaults"/>
    <cache alias="roleCommonPermissionRegion" uses-template="myDefaults"/>
    <cache alias="roleApiPermissionRegion" uses-template="myDefaults"/>
    <cache alias="roleExternalPermissionRegion" uses-template="myDefaults"/>
    <cache alias="corsOriginRegion" uses-template="myDefaults"/>
    <cache alias="exposedHeadersRegion" uses-template="myDefaults"/>
    <cache alias="allowedHeadersRegion" uses-template="myDefaults"/>
    <cache alias="clientGrantTypeRegion" uses-template="myDefaults"/>
    <cache alias="cacheControlRegion" uses-template="myDefaults"/>
    <cache alias="linkedPermissionIdsRegion" uses-template="myDefaults"/>
    <cache alias="loginRegion" uses-template="myDefaults"/>
    <cache alias="subRequestRegion" uses-template="myDefaults"/>
    <cache alias="loginHistoryRegion" uses-template="myDefaults"/>
    <cache alias="jobRegion" uses-template="myDefaults"/>
    <!--  start of config hibernate query cache size to avoid OOM issue
        ref:https://stackoverflow.com/questions/57820519/what-is-the-standardquerycache-alternative-in-hibernate-5-4-4
        ref2:https://github.com/hibernate/hibernate-orm/blob/main/documentation/src/main/asciidoc/userguide/chapters/caching/Caching.adoc
    -->
    <cache alias="default-query-results-region" uses-template="myDefaults">
        <resources>
            <heap unit="MB">20</heap>
            <offheap unit="MB">30</offheap>
        </resources>
    </cache>
    <cache alias="default-update-timestamps-region" uses-template="myDefaults">
        <expiry>
            <none/>
        </expiry>
        <resources>
            <heap unit="MB">20</heap>
            <offheap unit="MB">30</offheap>
        </resources>
    </cache>
    <!--  end  -->
    <cache-template name="myDefaults">
        <expiry>
            <ttl unit="seconds">10</ttl>
        </expiry>
        <resources>
            <heap unit="MB">19</heap>
            <offheap unit="MB">20</offheap>
        </resources>
        <!--        increase max object graph size after config hibernate query cache size-->
        <heap-store-settings>
            <!--            max object graph size is a counter of java references-->
            <!--            if the total of distinct references in this graph goes beyond the value specified, the mapping will not be cached.-->
            <max-object-graph-size>2000</max-object-graph-size>
        </heap-store-settings>
    </cache-template>
</config>