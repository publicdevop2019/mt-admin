<div style="display: flex; justify-content: end;">
    <button mat-button color="primary" (click)="dismiss($event)">
        <mat-icon>close </mat-icon>
    </button>
</div>
<ng-container *ngIf="data.context === 'clone' || data.context === 'new'">
    <lib-factory [formId]="formId"></lib-factory>
    <h4>{{'SELECT_PERMISIONS'|translate}}</h4>
    <app-dynamic-tree [loadRoot]="loadRoot" [loadChildren]="loadChildren" [fg]="commonPermissionFg">
    </app-dynamic-tree>
    <h4>{{'SELECT_API_PERMISIONS'|translate}}</h4>
    <app-dynamic-tree [loadRoot]="loadRootApi" [loadChildren]="loadChildrenApi" [fg]="apiPermissionFg">
    </app-dynamic-tree>
    <lib-factory [formId]="formIdShared"></lib-factory>
    <button mat-raised-button color="primary" class="app-btn" (click)="create()">{{'CREATE'|translate}}</button>
</ng-container>
<ng-container *ngIf="data.context === 'edit'">
    <mat-tab-group mat-align-tabs="start" dynamicHeight>
        <mat-tab label="{{'BASIC_INFO'|translate}}"  #basicTab>
            <div style="margin-top: 16px;">
                <lib-factory [formId]="formId"></lib-factory>
            </div>
        </mat-tab>
        <mat-tab label="{{'COMMON_PERMISSIONS'|translate}}" #commonTab>
            <div style="margin-top: 16px;">
                <mat-chip-list >
                    <mat-chip *ngFor="let e of commonPermissions()" [removable]="true">
                        {{parseId(e)}}
                        <mat-icon matChipRemove (click)="commonRemove(e)">cancel</mat-icon>
                    </mat-chip>
                </mat-chip-list>
                <app-dynamic-tree [loadRoot]="loadRoot" [loadChildren]="loadChildren" [fg]="commonPermissionFg" #treeCommon
                   ></app-dynamic-tree>
            </div>
        </mat-tab>
        <mat-tab label="{{'API_PERMISSIONS'|translate}}" #apiTab>
            <div style="margin-top: 16px;">
                <mat-chip-list >
                    <mat-chip *ngFor="let e of apiPermissions()" [removable]="true">
                        {{parseId(e)}}
                        <mat-icon matChipRemove (click)="apiRemove(e)">cancel</mat-icon>
                    </mat-chip>
                </mat-chip-list>
                <app-dynamic-tree [loadRoot]="loadRootApi" [loadChildren]="loadChildrenApi" [fg]="apiPermissionFg"
                   ></app-dynamic-tree>
                <lib-factory [formId]="formIdShared"></lib-factory>
            </div>
        </mat-tab>
    </mat-tab-group>
    <button mat-raised-button color="primary" *ngIf="data.context === 'edit'" class="app-btn"
        (click)="update()">{{'UPDATE'|translate}}</button>
</ng-container>